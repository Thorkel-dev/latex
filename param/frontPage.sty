%-----------------------------------------------
%   LaTeX template front page
%   Written By: Thorkel-dev
%-----------------------------------------------

\ProvidesPackage{FrontPage}
\RequirePackage{Parameter}
\RequirePackage{kvoptions}
\usepackage{colortbl}
\RequirePackage[export]{adjustbox} % http://ctan.org/pkg/adjustbox

\DeclareStringOption[]{logoCompany}[]
\DeclareStringOption[]{logoEseo}[]
\DeclareStringOption[]{stageType}[]
\DeclareStringOption[]{companyName}[]
\DeclareStringOption[]{subject}[]
\DeclareStringOption[]{tutor}[]
\DeclareStringOption[]{option}[]
\DeclareStringOption[]{privacyLevel}[]
\DeclareStringOption[]{domain}[]
\DeclareStringOption[]{date}[]

\ProcessKeyvalOptions*

\fancypagestyle{} % No header and footer for this page
{
    \fancyhf{}
    \fancyrf{}
}

\makeatletter

\renewcommand\maketitle{
    \thispagestyle{empty}

    \begin{minipage}{.59\linewidth}
        \raggedright
        \includegraphics[width=0.75\textwidth]{\FrontPage@logoEseo}
    \end{minipage}
    \hfill
    \begin{minipage}{.25\linewidth}
        \Large
        \raggedleft
        \textbf{\@author}
    \end{minipage}

    \vspace{\fill}

    \begin{center}
        \rule{\linewidth}{1pt}\\
        \vspace{1em}
        {\huge\textbf{\@title}}\\
        \vspace{1em}
        {\footnotesize\textit{\FrontPage@stageType}}\\
        \rule{\linewidth}{1pt}
    \end{center}

    \vspace{1em}

    \begin{table}[H]
        \begin{tabularx}{\textwidth}{lX}
            \textbf{Entreprise}        & \FrontPage@companyName \\
            \textbf{Dates}             & \FrontPage@date \\
            \textbf{Sujet de stage}             & \FrontPage@subject        \\
            \textbf{Tuteur Entreprise} & \FrontPage@tutor          \\
        \end{tabularx}
    \end{table}

    \vfill

    \begin{figure}[H]
        \centering
        \includegraphics[width=0.6\textwidth]{\FrontPage@logoCompany}
    \end{figure}

    \vfill

    \begin{table}[b]
        \centering
        \begin{tabularx}{\textwidth}{lX}
            \textbf{Option}             & \FrontPage@option                                      \\
            \textbf{Confidentialit√©}    & Rapport confidentiel de niveau \FrontPage@privacyLevel \\
            \textbf{Domaine Entreprise} & \FrontPage@domain                                      \\
        \end{tabularx}
    \end{table}

    \vspace{3em}
    \clearpage
    \pagenumbering{arabic} % restart the page numbering
}

\makeatother
